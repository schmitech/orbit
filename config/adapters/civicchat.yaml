# Intent Retriever Adapters
# These adapters use intent classification to generate queries from natural language
# Supports SQL, DuckDB, PostgreSQL, Elasticsearch, MongoDB, HTTP APIs, and Firecrawl

adapters:
  - name: "intent-duckdb-open-gov-travel-expenses"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/goc-disclosure/government-travel-expenses/goc-disclosure-travel-expenses.duckdb"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/goc-disclosure/government-travel-expenses/travel_expenses_domain.yaml"
      template_library_path:
        - "../orbit-adapters/goc-disclosure/government-travel-expenses/travel_expenses_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_open_gov_travel_expenses_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.8

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      # Database path is configured in datasources.yaml (defaults to examples/duckdb/analytics.duckdb)
      # Can override here if needed:
      # database: "path/to/custom.duckdb"  # Optional: override datasource default
      read_only: true  # Allow concurrent reads from multiple processes (no writes needed for intent queries)
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously (see https://duckdb.org/docs/stable/connect/concurrency)
      threads: null  # Use default thread count

      # Query monitoring (automatically provided by unified base)
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-open-gov-contracts"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/goc-disclosure/government-contracts/goc-disclosure-contracts.duckdb"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/goc-disclosure/government-contracts/contracts_domain.yaml"
      template_library_path:
        - "../orbit-adapters/goc-disclosure/government-contracts/contracts_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_open_gov_contracts_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      # Database path is configured in datasources.yaml (defaults to examples/duckdb/analytics.duckdb)
      # Can override here if needed:
      # database: "path/to/custom.duckdb"  # Optional: override datasource default
      read_only: true  # Allow concurrent reads from multiple processes (no writes needed for intent queries)
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously (see https://duckdb.org/docs/stable/connect/concurrency)
      threads: null  # Use default thread count

      # Query monitoring (automatically provided by unified base)
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-open-gov-hospitality-expenses"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/goc-disclosure/government-hospitality-expenses/goc-disclosure-hospitality.duckdb"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/goc-disclosure/government-hospitality-expenses/hospitality_expenses_domain.yaml"
      template_library_path:
        - "../orbit-adapters/goc-disclosure/government-hospitality-expenses/hospitality_expenses_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_open_gov_hospitality_expenses_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.5

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes (no writes needed for intent queries)
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously (see https://duckdb.org/docs/stable/connect/concurrency)
      threads: null  # Use default thread count

      # Query monitoring (automatically provided by unified base)
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-ottawa-police-criminal-offences"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/ottawa-police/criminal-offences/ottawa-police-criminal-offences.duckdb"
    inference_provider: "deepseek"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/ottawa-police/criminal-offences/criminal_offences_domain.yaml"
      template_library_path:
        - "../orbit-adapters/ottawa-police/criminal-offences/criminal_offences_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_ottawa_police_criminal_offences_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously
      threads: null  # Use default thread count

      # Query monitoring
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-ottawa-police-auto-theft"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/ottawa-police/auto-theft/ottawa-police-auto-theft.duckdb"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/ottawa-police/auto-theft/auto_theft_domain.yaml"
      template_library_path:
        - "../orbit-adapters/ottawa-police/auto-theft/auto_theft_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_ottawa_police_auto_theft_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously
      threads: null  # Use default thread count

      # Query monitoring
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-toronto-police-auto-theft"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/toronto-police/toronto-police-auto-theft.duckdb"
    inference_provider: "deepseek"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/toronto-police/auto_theft_domain.yaml"
      template_library_path:
        - "../orbit-adapters/toronto-police/auto_theft_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_toronto_police_auto_theft_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously
      threads: null  # Use default thread count

      # Query monitoring
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds    

  - name: "intent-duckdb-ottawa-hospital-ed-visits"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/ottawa-hospital/ottawa-hospital-ed-respiratory-visits.duckdb"
    inference_provider: "deepseek"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/ottawa-hospital/ed_visits_domain.yaml"
      template_library_path:
        - "../orbit-adapters/ottawa-hospital/ed_visits_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_ottawa_hospital_ed_visits_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 100

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously
      threads: null  # Use default thread count

      # Query monitoring
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds

  - name: "intent-duckdb-alberta-shelter-occupancy"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/alberta-shelter/alberta-shelter-occupancy.duckdb"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    # model: "nvidia/nemotron-3-nano-30b-a3b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      requires_api_key_validation: true
      supports_autocomplete: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/alberta-shelter/shelter_occupancy_domain.yaml"
      template_library_path:
        - "../orbit-adapters/alberta-shelter/shelter_occupancy_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb_alberta_shelter_occupancy_templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 1000

      # Template loading settings
      reload_templates_on_start: true  # Whether to reload templates on startup
      force_reload_templates: true  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes (no writes needed for intent queries)
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously (see https://duckdb.org/docs/stable/connect/concurrency)
      threads: null  # Use default thread count

      # Query monitoring (automatically provided by unified base)
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds
  
  # Example: Government Data Explorer
  # Routes queries across multiple government open data sources
  - name: "composite-government-data"
    enabled: true  # Enable when child adapters are configured
    type: "retriever"
    adapter: "composite"
    implementation: "retrievers.implementations.composite.CompositeIntentRetriever"
    inference_provider: "ollama_cloud"
    model: "glm-4.7"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"

    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      supports_autocomplete: true  # Enable autocomplete from child adapter templates
      requires_api_key_validation: true

    config:
      # Child adapters to search across
      child_adapters:
        - "intent-duckdb-open-gov-travel-expenses"
        - "intent-duckdb-open-gov-contracts"
        - "intent-duckdb-open-gov-hospitality-expenses"

      confidence_threshold: 0.5
      max_templates_per_source: 5
      parallel_search: true
      search_timeout: 5.0
      verbose: false

        # Example: Government Data Explorer
  # Routes queries across multiple government open data sources
  - name: "composite-ottawa-police-data"
    enabled: true  # Enable when child adapters are configured
    type: "retriever"
    adapter: "composite"
    implementation: "retrievers.implementations.composite.CompositeIntentRetriever"
    inference_provider: "ollama_cloud"
    model: "gpt-oss:120b"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"

    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      supports_autocomplete: true  # Enable autocomplete from child adapter templates
      requires_api_key_validation: true

    config:
      # Child adapters to search across
      child_adapters:
        - "intent-duckdb-ottawa-police-auto-theft"
        - "intent-duckdb-ottawa-police-criminal-offences"

      confidence_threshold: 0.5  # Lowered from 0.75 - was filtering out valid matches
      max_templates_per_source: 5
      parallel_search: true
      search_timeout: 5.0
      verbose: false

  - name: "intent-duckdb-goc-ai-register"
    enabled: true
    type: "retriever"
    datasource: "duckdb"
    adapter: "intent"
    implementation: "retrievers.implementations.intent.IntentDuckDBRetriever"
    database: "../orbit-adapters/goc-ised-ai-mvp/goc-ised-ai-register.duckdb"
    inference_provider: "cohere"
    embedding_provider: "ollama"
    embedding_model: "nomic-embed-text"
    capabilities:
      retrieval_behavior: "always"
      formatting_style: "standard"
      supports_file_ids: false
      supports_session_tracking: false
      supports_threading: true
      supports_autocomplete: true  # Enable autocomplete from child adapter templates
      requires_api_key_validation: true
    config:
      # Path to the domain definition file
      domain_config_path: "../orbit-adapters/goc-ised-ai-mvp/ai_register_domain.yaml"
      template_library_path:
        - "../orbit-adapters/goc-ised-ai-mvp/ai_register_templates.yaml"

      # Name for the vector store collection for templates
      template_collection_name: "duckdb-goc-ai-register-templates"
      # Store configuration - references stores.yaml
      store_name: "chroma"
      confidence_threshold: 0.4

      # Maximum templates to consider
      max_templates: 5

      # Return top N results
      return_results: 1000

      # Template loading settings
      reload_templates_on_start: false  # Whether to reload templates on startup
      force_reload_templates: false  # Force reload even if templates exist in storage

      # DuckDB-specific configuration
      read_only: true  # Allow concurrent reads from multiple processes
      access_mode: "READ_ONLY"  # Multiple processes can read simultaneously
      threads: null  # Use default thread count

      # Query monitoring
      enable_query_monitoring: true
      query_timeout: 5000  # 5 seconds